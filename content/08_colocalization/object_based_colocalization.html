
<!DOCTYPE html>

<html data-content_root="../../" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Object-based colocalization analysis — BoBiAC Book</title>
<script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
<!-- Loaded before other Sphinx assets -->
<link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet"/>
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet"/>
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet"/>
<link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../_static/pygments.css?v=03e43079" rel="stylesheet" type="text/css"/>
<link href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" rel="stylesheet" type="text/css"/>
<link href="../../_static/togglebutton.css?v=13237357" rel="stylesheet" type="text/css"/>
<link href="../../_static/copybutton.css?v=76b2166b" rel="stylesheet" type="text/css"/>
<link href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" rel="stylesheet" type="text/css"/>
<link href="../../_static/sphinx-thebe.css?v=4fa983c6" rel="stylesheet" type="text/css"/>
<link href="../../_static/sphinx-design.min.css?v=95c83b7e" rel="stylesheet" type="text/css"/>
<link href="../../_static/styles/custom.css?v=dd2a99f2" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" rel="preload"/>
<link as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" rel="preload"/>
<script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
<script src="../../_static/doctools.js?v=9a2dae69"></script>
<script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
<script src="../../_static/copybutton.js?v=f281be69"></script>
<script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
<script>let toggleHintShow = 'Click to show';</script>
<script>let toggleHintHide = 'Click to hide';</script>
<script>let toggleOpenOnPrint = 'true';</script>
<script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
<script src="../../_static/design-tabs.js?v=f930bc37"></script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
<script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
<script>DOCUMENTATION_OPTIONS.pagename = 'content/08_colocalization/object_based_colocalization';</script>
<script src="../../_static/scripts/custom.js?v=4332ec77"></script>
<link href="../../genindex.html" rel="index" title="Index"/>
<link href="../../search.html" rel="search" title="Search"/>
<link href="../09_reproducibility_and_image_ethics/reproducibility_and_image_ethics.html" rel="next" title="09 - Reproducibility and Image Ethics"/>
<link href="pixel_intensity_based_colocalization_manders.html" rel="prev" title="Manders’ Correlation Coefficients"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
</head>
<body data-bs-root-margin="0px 0px -60%" data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-default-mode="" data-offset="180">
<div class="skip-link d-print-none" id="pst-skip-link"><a href="#main-content">Skip to main content</a></div>
<div id="pst-scroll-pixel-helper"></div>
<button class="btn rounded-pill" id="pst-back-to-top" type="button">
<i class="fa-solid fa-arrow-up"></i>Back to top</button>
<input class="sidebar-toggle" id="pst-primary-sidebar-checkbox" type="checkbox"/>
<label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
<input class="sidebar-toggle" id="pst-secondary-sidebar-checkbox" type="checkbox"/>
<label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
<div class="search-button__wrapper">
<div class="search-button__overlay"></div>
<div class="search-button__search-container">
<form action="../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search this book..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
</div>
<div class="pst-async-banner-revealer d-none">
<aside aria-label="Version warning" class="d-none d-print-none" id="bd-header-version-warning"></aside>
</div>
<header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
</header>
<div class="bd-container">
<div class="bd-container__inner bd-page-width">
<div class="bd-sidebar-primary bd-sidebar">
<div class="sidebar-header-items sidebar-primary__section">
</div>
<div class="sidebar-primary-items__start sidebar-primary__section">
<div class="sidebar-primary-item">
<a class="navbar-brand logo" href="../../landing-page.html">
<img alt="BoBiAC Book - Home" class="logo__image only-light" src="../../_static/bobiac_logos_svgexport-03.svg"/>
<script>document.write(`<img src="../../_static/bobiac_logos_svgexport-04.svg" class="logo__image only-dark" alt="BoBiAC Book - Home"/>`);</script>
</a></div>
<div class="sidebar-primary-item">
<script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
<div class="sidebar-primary-item"><nav aria-label="Main" class="bd-links bd-docs-nav">
<div class="bd-toc-item navbar-nav active">
<ul class="nav bd-sidenav bd-sidenav__home-link">
<li class="toctree-l1">
<a class="reference internal" href="../../landing-page.html">
<i class="fas fa-home"></i> Home
                </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Course Material</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../01_intro_to_bobiac/bobiac_intro.html">01 - <i class="fas fa-image"></i> Introduction to BoBiAC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_getting_started_with_python/getting_started_with_python.html">02 - <i class="fab fa-python"></i> Getting Started with Python and <code class="docutils literal notranslate"><span class="pre">uv</span></code></a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../03_python_basics/python_basics.html">03 - <i class="fab fa-python"></i> Python Basics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../03_python_basics/python_basics_notebook.html">The Python Basics Notebook</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../04_digital_images_intro/digital_images_intro.html">04 - <i class="fas fa-table-cells"></i> Introduction to Digital Images</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../04_digital_images_intro/python_for_bioimage_analysis.html">Python for bioimage analysis</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../05_segmentation/segmentation_intro.html">05 - <i class="fa-solid fa-disease"></i> Image Segmentation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../05_segmentation/classic/classic.html">Classical Methods</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../05_segmentation/classic/classic_segmentation.html">Classical Segmentation</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../05_segmentation/machine_learning/machine_learning.html">Machine Learning Methods</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../05_segmentation/machine_learning/intro_to_ilastik.html">Introduction to Ilastik</a></li>
<li class="toctree-l3"><a class="reference internal" href="../05_segmentation/machine_learning/pixel_classification_with_ilastik.html">Ilastik for Pixel Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../05_segmentation/machine_learning/from_ilastik_masks_to_labels.html">From Ilastik Masks to Labels</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../05_segmentation/deep_learning/deep_learning.html">Deep Learning Methods</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../05_segmentation/deep_learning/intro_to_cellpose.html">Introduction to Cellpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="../05_segmentation/deep_learning/cellpose_notebook.html">Cellpose in Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../05_segmentation/deep_learning/cellpose_retraining_colab.html">Retraining Cellpose on Custom Data</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../06_object_classification/object_classification.html">06 - <i class="fa-solid fa-shapes"></i> Object Classification</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../06_object_classification/object_classification_with_ilastik.html">Ilastik for Object Classification</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../07_measurement_and_quantification/measurement_and_quantification_intro.html">07 - <i class="fa-solid fa-chart-simple"></i> Measurements &amp; Quantification</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../07_measurement_and_quantification/measurement_and_quantification_notebook.html">Measurements &amp; Quantification Notebook</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07_measurement_and_quantification/background_correction_notebook.html">Background Correction</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="colocalization_intro.html">08 - <i class="fa-solid fa-location-crosshairs"></i> Colocalization</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pixel_intensity_based_colocalization_pearsons.html">Pearson’s correlation coefficient</a></li>
<li class="toctree-l2"><a class="reference internal" href="pixel_intensity_based_colocalization_manders.html">Manders’ Correlation Coefficients</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Object-based colocalization analysis</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../09_reproducibility_and_image_ethics/reproducibility_and_image_ethics.html">09 - <i class="fa-solid fa-rotate-right"></i> Reproducibility and Image Ethics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Student Working Groups</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../student_group_work/student_group_work.html"><i class="fa-solid fa-user-group"></i> Student Group Work</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../student_group_work/evaluation-notebook.html">Evaluation Notebook</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Course Materials Downloads</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../data/course_downloads.html"><i class="fa-solid fa-folder"></i> Downloads</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://iac.hms.harvard.edu/bobiac/2025">BoBiAC</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.astral.sh/uv/">uv</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/manzt/juv">juv</a></li>
<li class="toctree-l1"><a class="reference external" href="https://iac.hms.harvard.edu">Image Analysis Collaboratory (IAC)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://cite.hms.harvard.edu">Core for Imaging Technology &amp; Education (CITE)</a></li>
</ul>
</div>
</nav></div>
</div>
<div class="sidebar-primary-items__end sidebar-primary__section">
</div>
<div id="rtd-footer-container"></div>
</div>
<main class="bd-main" id="main-content" role="main">
<div class="sbt-scroll-pixel-helper"></div>
<div class="bd-content">
<div class="bd-article-container">
<div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
<div class="header-article-items__start">
<div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" data-bs-placement="bottom" data-bs-toggle="tooltip" title="Toggle primary sidebar">
<span class="fa-solid fa-bars"></span>
</button></div>
</div>
<div class="header-article-items__end">
<div class="header-article-item">
<div class="article-header-buttons">
<a class="btn btn-sm btn-source-repository-button" data-bs-placement="bottom" data-bs-toggle="tooltip" href="https://github.com/HMS-IAC/bobiac" target="_blank" title="Source repository">
<span class="btn__icon-container">
<i class="fab fa-github"></i>
</span>
</a>
<button class="btn btn-sm btn-fullscreen-button" data-bs-placement="bottom" data-bs-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="btn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>
<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" data-bs-placement="bottom" data-bs-toggle="tooltip" title="Toggle secondary sidebar">
<span class="fa-solid fa-list"></span>
</button>
</div></div>
</div>
</div>
</div>
<div class="onlyprint" id="jb-print-docs-body">
<h1>Object-based colocalization analysis</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2 style="color: black; background-color: rgb(127,196,125); padding: 3px; border-radius: 5px;"> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Object-based colocalization analysis</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#description">Description</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectives">Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-data">0. Load the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-data">1. Plot the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-nearest-neighbor-distance">2. Mean nearest neighbor distance</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-code-along">✍️ Exercise: Code along</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-fall-samples">Compute Fall samples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-fall-samples">Plot Fall samples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-winter-samples">Compute Winter samples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-winter-samples">Plot Winter samples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-change-the-order-of-points-provided-to-meannn-for-the-winter-samples">✍️ Exercise: Change the order of points provided to <code class="docutils literal notranslate"><span class="pre">meanNN()</span></code> for the winter samples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-results">Plot the results</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nearest-neighbor-function">3. Nearest neighbor function</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-radii-for-which-to-evaluate-the-nearest-neighbor-function">Define radii for which to evaluate the nearest neighbor function</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-fall-samples">Inspect the fall samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-winter-samples">Inspect the winter samples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ripley-s-k-function">4. Ripley’s K function</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-radii-for-which-to-compute-ripley-s-k-function">Define radii for which to compute Ripley’s K function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-think-should-these-be-the-same-maximum-radius-as-provided-to-the-nearest-neighbor-function">✍️ Exercise: Think: Should these be the same maximum radius as provided to the nearest neighbor function?</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-k-for-the-fall-samples">Compute K for the fall samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-k-for-the-winter-samples">Compute K for the winter samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#here-we-change-the-order-to-bob-iac-for-k-winter-medium">Here, we change the order to BOB -&gt; IAC for <code class="docutils literal notranslate"><span class="pre">k_winter_medium</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-results">Inspect the results</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fall-samples">Fall samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#winter-samples">Winter samples</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ripley-s-k-with-edge-correction">4.1 Ripley’s K with edge correction</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-fall-samples">Compute the fall samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-winter-samples">Compute the winter samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-a-fall-sample-with-edge-correction">Plot a fall sample with edge correction</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-a-winter-sample-with-edge-correction">Plot a winter sample with edge correction</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validations-the-null-distribution">5. Validations - the null distribution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-null-distribution-of-the-nearest-neighbor-function">Calculate the null distribution of the nearest neighbor function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-try-different-values-for-n-and-area">✍️ Exercise: Try different values for <code class="docutils literal notranslate"><span class="pre">n</span></code> and <code class="docutils literal notranslate"><span class="pre">area</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-fall-samples">Plot the fall samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-winter-samples">Plot the winter samples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validation-monte-carlo-based-null-hypothesis-testing">6. Validation - Monte-Carlo based null-hypothesis testing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-code-along-blindly-throw-darts-at-a-20-x-20-cm-board">✍️ Exercise, code along: Blindly throw darts at a 20 x 20 cm board</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulate-under-the-null-hypothesis">6.1 Simulate under the null hypothesis</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-random-results">Inspect the random results</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-mean-nearest-neighbor-distance">6.2 Validate - Mean nearest neighbor distance</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-mean-nearest-neighbor-distance-for-each-random-dataset">Calculate the mean nearest neighbor distance for each random dataset</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-significance-level-for-later-testing">Define significance level for later testing</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Fall samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Winter samples</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-nearest-neighbor-function">6.3 Validate - Nearest neighbor function</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-confidence-intervals-for-the-nearest-neighbor-function">Plot confidence intervals for the nearest neighbor function:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-nearest-neighbor-function-for-all-random-samples">Compute the nearest neighbor function for all random samples</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Fall samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Winter samples</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-ripley-s-k">6.4 Validate - Ripley’s K</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-ripley-s-k-for-all-randomly-generated-samples">Compute Ripley’s K for all randomly generated samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Fall samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Winter samples</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div id="searchbox"></div>
<article class="bd-article">
<section class="tex2jax_ignore mathjax_ignore" id="object-based-colocalization-analysis">
<h1>Object-based colocalization analysis<a class="headerlink" href="#object-based-colocalization-analysis" title="Link to this heading">#</a></h1>
<div class="custom-button-row">
<a class="custom-button custom-download-button" download="" href="../../notebooks/08_colocalization/object_based_colocalization.ipynb">
<i class="fas fa-download"></i> Download this Notebook
    </a>
<a class="custom-button custom-download-button" href="https://colab.research.google.com/github/HMS-IAC/bobiac/blob/gh-pages/colab_notebooks/08_colocalization/object_based_colocalization.ipynb" target="_blank">
<img alt="Open in Colab" class="button-icon" src="../../_static/logo/icon-google-colab.svg"/>
        Open in Colab
    </a>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># /// script</span>
<span class="c1"># requires-python = "&gt;=3.12"</span>
<span class="c1"># dependencies = [</span>
<span class="c1">#     "locan",</span>
<span class="c1">#     "matplotlib",</span>
<span class="c1">#     "ndv[jupyter,vispy]",</span>
<span class="c1">#     "numpy",</span>
<span class="c1">#     "scikit-image",</span>
<span class="c1">#     "scipy",</span>
<span class="c1">#     "shapely",</span>
<span class="c1">#     "tifffile",</span>
<span class="c1"># ]</span>
<span class="c1"># ///</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="description">
<h1>Description<a class="headerlink" href="#description" title="Link to this heading">#</a></h1>
<p>In this Notebook, we learn about point-based colocalization analysis</p>
<section id="objectives">
<h2 style="color: black; background-color: rgb(127,196,125); padding: 3px; border-radius: 5px;">Objectives<a class="headerlink" href="#objectives" title="Link to this heading">#</a></h2>
<p>Learn about mean nearest neighbor, the nearest neighbor function, and Ripley’s K function.<br/>
Learn Monte Carlo based validation.</p>
</section>
<section id="table-of-contents">
<h2 style="color: black; background-color: rgb(127,196,125); padding: 3px; border-radius: 5px;">Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">#</a></h2>
<ol class="arabic simple" start="0">
<li><p>Load the data</p></li>
<li><p>Plot the data</p></li>
<li><p>Mean nearest neighbor distance</p></li>
<li><p>Nearest neighbor function</p></li>
<li><p>Ripley’s K - with and without boundary correction</p></li>
<li><p>Validation - the null distribution</p></li>
<li><p>Validation - Monte Carlo based null hypothesis testing</p></li>
</ol>
<p>In this exercise, we will use the <a download="" href="../../_static/data/08_object_based_colocalization.zip"> <i class="fas fa-download"></i> Object Based Colocalization Dataset</a> .</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rich</span><span class="w"> </span><span class="kn">import</span> <span class="nb">print</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.spatial</span><span class="w"> </span><span class="kn">import</span> <span class="n">distance_matrix</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">shapely.geometry</span><span class="w"> </span><span class="kn">import</span> <span class="n">Point</span><span class="p">,</span> <span class="n">box</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-the-data">
<h2 style="color: black; background-color: rgb(127,196,125); padding: 3px; border-radius: 5px;">0. Load the data<a class="headerlink" href="#load-the-data" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">base</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"../../_static/images/coloc/obj_based/"</span><span class="p">)</span>

<span class="n">fall_med_iac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">base</span> <span class="o">/</span> <span class="s2">"p_400_c1.csv"</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">)</span>
<span class="n">fall_med_bob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">base</span> <span class="o">/</span> <span class="s2">"p_400_c2.csv"</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">)</span>
<span class="n">fall_cold_iac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">base</span> <span class="o">/</span> <span class="s2">"g_p_400_dual_1.csv"</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">)</span>
<span class="n">fall_cold_bob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">base</span> <span class="o">/</span> <span class="s2">"g_p_400_dual_2.csv"</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">)</span>
<span class="n">fall_warm_iac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">base</span> <span class="o">/</span> <span class="s2">"p_400_c1_rep.csv"</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">)</span>
<span class="n">fall_warm_bob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">base</span> <span class="o">/</span> <span class="s2">"p_400_c2_rep.csv"</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">)</span>
<span class="n">winter_warm_iac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">base</span> <span class="o">/</span> <span class="s2">"g_p_400_c1.csv"</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">)</span>
<span class="n">winter_warm_bob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">base</span> <span class="o">/</span> <span class="s2">"g_p_400_c2.csv"</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">)</span>
<span class="n">winter_medium_iac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">base</span> <span class="o">/</span> <span class="s2">"g_p_as_c1.csv"</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">)</span>
<span class="n">winter_medium_bob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">base</span> <span class="o">/</span> <span class="s2">"g_p_as_c2.csv"</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">)</span>
<span class="n">winter_cold_iac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">base</span> <span class="o">/</span> <span class="s2">"g_p_400_c1_cor.csv"</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">)</span>
<span class="n">winter_cold_bob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">base</span> <span class="o">/</span> <span class="s2">"g_p_400_c2_cor.csv"</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">","</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-the-data">
<h2 style="color: black; background-color: rgb(127,196,125); padding: 3px; border-radius: 5px;">1. Plot the data<a class="headerlink" href="#plot-the-data" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plotloc_2c</span><span class="p">(</span>
    <span class="n">points_iac</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">points_bob</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
    <span class="n">ch1</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"IAC"</span><span class="p">,</span>
    <span class="n">ch2</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"BOB"</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Plot two channels in a 2D space.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    points_iac (np.ndarray): Points for channel 1.</span>
<span class="sd">    points_bob (np.ndarray): Points for channel 2.</span>
<span class="sd">    """</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">points_iac</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">points_iac</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">"blue"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">ch1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">points_bob</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">points_bob</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">c</span><span class="o">=</span><span class="s2">"magenta"</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">ch2</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">"s"</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"x [au]"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"y [au]"</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">"equal"</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s2">"box"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">fall_med_iac</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">fall_med_bob</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">plotloc_2c</span><span class="p">(</span><span class="n">fall_med_iac</span><span class="p">,</span> <span class="n">fall_med_bob</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Fall, medium"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">400</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span><span style="font-weight: bold">)</span>
<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">400</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span><span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/e9df1815386ca4bb02c502e237278c1d02d40f484e6afdacdcdaeb9c90912a7b.png" src="../../_images/e9df1815386ca4bb02c502e237278c1d02d40f484e6afdacdcdaeb9c90912a7b.png">
</img></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">fall_cold_iac</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">fall_cold_bob</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">plotloc_2c</span><span class="p">(</span><span class="n">fall_cold_iac</span><span class="p">,</span> <span class="n">fall_cold_bob</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Fall, cold"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">400</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span><span style="font-weight: bold">)</span>
<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">400</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span><span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/7433031ccfa9de0091426cdff4c527a75ebdaf74a2bfc2b6d6c19615cad5bdce.png" src="../../_images/7433031ccfa9de0091426cdff4c527a75ebdaf74a2bfc2b6d6c19615cad5bdce.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">fall_warm_iac</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">fall_warm_bob</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">plotloc_2c</span><span class="p">(</span><span class="n">fall_warm_iac</span><span class="p">,</span> <span class="n">fall_warm_bob</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Fall, warm"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">400</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span><span style="font-weight: bold">)</span>
<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">400</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span><span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/8c9f43cc3ce6cc4b710ee82537c9f28e6f7b971d89c26c98bfb9354a2cd91f6f.png" src="../../_images/8c9f43cc3ce6cc4b710ee82537c9f28e6f7b971d89c26c98bfb9354a2cd91f6f.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">winter_cold_iac</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">winter_cold_bob</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">plotloc_2c</span><span class="p">(</span><span class="n">winter_cold_iac</span><span class="p">,</span> <span class="n">winter_cold_bob</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Winter, cold"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">400</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span><span style="font-weight: bold">)</span>
<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">400</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span><span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/d6165a462f151c88b566f43cf1e98c4731fa7c28587e8ab91da4fff51794eef0.png" src="../../_images/d6165a462f151c88b566f43cf1e98c4731fa7c28587e8ab91da4fff51794eef0.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">winter_medium_iac</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">winter_medium_bob</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">plotloc_2c</span><span class="p">(</span><span class="n">winter_medium_iac</span><span class="p">,</span> <span class="n">winter_medium_bob</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Winter, medium"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">400</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span><span style="font-weight: bold">)</span>
<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">200</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span><span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/ff6bd7b4254e99d9da00e6a70e75d1126b5e2b599d143648ad59bfb961d10426.png" src="../../_images/ff6bd7b4254e99d9da00e6a70e75d1126b5e2b599d143648ad59bfb961d10426.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">winter_warm_iac</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">winter_warm_bob</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">plotloc_2c</span><span class="p">(</span><span class="n">winter_warm_iac</span><span class="p">,</span> <span class="n">winter_warm_bob</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">"Winter, warm"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">400</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span><span style="font-weight: bold">)</span>
<span style="font-weight: bold">(</span><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">400</span>, <span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span><span style="font-weight: bold">)</span>
</pre>
</div><img alt="../../_images/40c6814f67e28f443f6ebc40526edc5af6cf2de80939cdbf0a10ac43a2df09aa.png" src="../../_images/40c6814f67e28f443f6ebc40526edc5af6cf2de80939cdbf0a10ac43a2df09aa.png"/>
</div>
</div>
</section>
<hr class="docutils"/>
<section id="mean-nearest-neighbor-distance">
<h2 style="color: black; background-color: rgb(127,196,125); padding: 3px; border-radius: 5px;">2. Mean nearest neighbor distance<a class="headerlink" href="#mean-nearest-neighbor-distance" title="Link to this heading">#</a></h2>
<section id="exercise-code-along">
<h3 style="color: black; background-color: rgb(252,185,118); padding: 3px; border-radius: 5px;">✍️ Exercise: Code along<a class="headerlink" href="#exercise-code-along" title="Link to this heading">#</a></h3>
<div class="cell tag_teacher docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">meanNN</span><span class="p">(</span><span class="n">points1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">points2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Computes the mean nearest neighbor distances for a set of 2D points.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - points1: array of shape (n_points, 2) representing the coordinates of the first set of points</span>
<span class="sd">    - points2: array of shape (n_points, 2) representing the coordinates of the second set of points; if None, uses points1</span>

<span class="sd">    Returns:</span>
<span class="sd">    - min_dists: array of minimum distances of each point in points1 to its nearest neighbor in points2</span>
<span class="sd">    - mean_nn: mean of the minimum distances</span>
<span class="sd">    """</span>

    <span class="n">d12</span> <span class="o">=</span> <span class="n">distance_matrix</span><span class="p">(</span><span class="n">points1</span><span class="p">,</span> <span class="n">points2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">points1</span> <span class="ow">is</span> <span class="n">points2</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">shares_memory</span><span class="p">(</span><span class="n">points1</span><span class="p">,</span> <span class="n">points2</span><span class="p">):</span>
        <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">d12</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>

    <span class="n">min_dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">d12</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">mean_nn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">min_dists</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">min_dists</span><span class="p">,</span> <span class="n">mean_nn</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="compute-fall-samples">
<h3 style="color: black; background-color: rgb(190,223,185); padding: 3px; border-radius: 5px;">Compute Fall samples<a class="headerlink" href="#compute-fall-samples" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nndist_fall_med</span><span class="p">,</span> <span class="n">meannn_fall_med</span> <span class="o">=</span> <span class="n">meanNN</span><span class="p">(</span><span class="n">fall_med_iac</span><span class="p">,</span> <span class="n">fall_med_bob</span><span class="p">)</span>
<span class="n">nndist_fall_cold</span><span class="p">,</span> <span class="n">meannn_fall_cold</span> <span class="o">=</span> <span class="n">meanNN</span><span class="p">(</span><span class="n">fall_cold_iac</span><span class="p">,</span> <span class="n">fall_cold_bob</span><span class="p">)</span>
<span class="n">nndist_fall_warm</span><span class="p">,</span> <span class="n">meannn_fall_warm</span> <span class="o">=</span> <span class="n">meanNN</span><span class="p">(</span><span class="n">fall_warm_iac</span><span class="p">,</span> <span class="n">fall_warm_bob</span><span class="p">)</span>


<span class="c1"># nndist_fall_med, meannn_fall_med = meanNN(fall_med_bob, fall_med_iac, )</span>
<span class="c1"># nndist_fall_cold, meannn_fall_cold = meanNN(fall_cold_bob, fall_cold_iac)</span>
<span class="c1"># nndist_fall_warm, meannn_fall_warm = meanNN(fall_warm_bob, fall_warm_iac)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-fall-samples">
<h3 style="color: black; background-color: rgb(190,223,185); padding: 3px; border-radius: 5px;">Plot Fall samples<a class="headerlink" href="#plot-fall-samples" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">nndist_fall_med</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fall medium"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">nndist_fall_cold</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fall cold"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">nndist_fall_warm</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fall warm"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"distance to nearest neighbor [a.u.]"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">meannn_fall_med</span><span class="p">,</span>
    <span class="n">c</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">"--"</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Fall medium: </span><span class="si">{</span><span class="n">meannn_fall_med</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">meannn_fall_cold</span><span class="p">,</span>
    <span class="n">c</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">":"</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Fall cold: </span><span class="si">{</span><span class="n">meannn_fall_cold</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">meannn_fall_warm</span><span class="p">,</span>
    <span class="n">c</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Fall warm: </span><span class="si">{</span><span class="n">meannn_fall_warm</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7ff6a1705100&gt;
</pre></div>
</div>
<img alt="../../_images/2b6fa59584ebcdff1ca1be193854acd09511d61b00eab70b3ea0078c5bc80827.png" src="../../_images/2b6fa59584ebcdff1ca1be193854acd09511d61b00eab70b3ea0078c5bc80827.png"/>
</div>
</div>
</section>
<section id="compute-winter-samples">
<h3 style="color: black; background-color: rgb(190,223,185); padding: 3px; border-radius: 5px;">Compute Winter samples<a class="headerlink" href="#compute-winter-samples" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nndist_winter_warm</span><span class="p">,</span> <span class="n">meannn_winter_warm</span> <span class="o">=</span> <span class="n">meanNN</span><span class="p">(</span><span class="n">winter_warm_iac</span><span class="p">,</span> <span class="n">winter_warm_bob</span><span class="p">)</span>
<span class="n">nndist_winter_medium</span><span class="p">,</span> <span class="n">meannn_winter_medium</span> <span class="o">=</span> <span class="n">meanNN</span><span class="p">(</span>
    <span class="n">winter_medium_iac</span><span class="p">,</span> <span class="n">winter_medium_bob</span>
<span class="p">)</span>
<span class="n">nndist_winter_cold</span><span class="p">,</span> <span class="n">meannn_winter_cold</span> <span class="o">=</span> <span class="n">meanNN</span><span class="p">(</span><span class="n">winter_cold_iac</span><span class="p">,</span> <span class="n">winter_cold_bob</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-winter-samples">
<h3 style="color: black; background-color: rgb(190,223,185); padding: 3px; border-radius: 5px;">Plot Winter samples<a class="headerlink" href="#plot-winter-samples" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">nndist_winter_cold</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter cold"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">nndist_winter_medium</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter medium"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">nndist_winter_warm</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter warm"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"distance to nearest neighbor [a.u.]"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">" IAC -&gt; BOB "</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">meannn_winter_cold</span><span class="p">,</span>
    <span class="n">c</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">":"</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Winter cold: </span><span class="si">{</span><span class="n">meannn_winter_cold</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">meannn_winter_medium</span><span class="p">,</span>
    <span class="n">c</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">"--"</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Winter medium: </span><span class="si">{</span><span class="n">meannn_winter_medium</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">meannn_winter_warm</span><span class="p">,</span>
    <span class="n">c</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Winter warm: </span><span class="si">{</span><span class="n">meannn_winter_warm</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7ff6a1706540&gt;
</pre></div>
</div>
<img alt="../../_images/165de865ed6f736c431eae57f215b788ce41a7c355178d2063165d23b2988657.png" src="../../_images/165de865ed6f736c431eae57f215b788ce41a7c355178d2063165d23b2988657.png"/>
</div>
</div>
</section>
<section id="exercise-change-the-order-of-points-provided-to-meannn-for-the-winter-samples">
<h3 style="color: black; background-color: rgb(252,185,118); padding: 3px; border-radius: 5px;">✍️ Exercise: Change the order of points provided to <code class="docutils literal notranslate"><span class="pre">meanNN()</span></code> for the winter samples<a class="headerlink" href="#exercise-change-the-order-of-points-provided-to-meannn-for-the-winter-samples" title="Link to this heading">#</a></h3>
<p>E.g. switch the order in which <code class="docutils literal notranslate"><span class="pre">winter_warm_iac</span></code> and <code class="docutils literal notranslate"><span class="pre">winter_warm_bob</span></code> is passed to <code class="docutils literal notranslate"><span class="pre">meanNN()</span></code>.<br/>
Do the same for <code class="docutils literal notranslate"><span class="pre">winter_cold_iac</span></code> and <code class="docutils literal notranslate"><span class="pre">winter_cold_bob</span></code>, as well as <code class="docutils literal notranslate"><span class="pre">winter_medium_iac</span></code> and <code class="docutils literal notranslate"><span class="pre">winter_medium_bob</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nndist_winter_warm_2</span><span class="p">,</span> <span class="n">meannn_winter_warm_2</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span> <span class="o">...</span>
<span class="n">nndist_winter_medium_2</span><span class="p">,</span> <span class="n">meannn_winter_medium_2</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span> <span class="o">...</span>
<span class="n">nndist_winter_cold_2</span><span class="p">,</span> <span class="n">meannn_winter_cold_2</span> <span class="o">=</span> <span class="o">...</span><span class="p">,</span> <span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_teacher docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nndist_winter_warm_2</span><span class="p">,</span> <span class="n">meannn_winter_warm_2</span> <span class="o">=</span> <span class="n">meanNN</span><span class="p">(</span><span class="n">winter_warm_bob</span><span class="p">,</span> <span class="n">winter_warm_iac</span><span class="p">)</span>
<span class="n">nndist_winter_medium_2</span><span class="p">,</span> <span class="n">meannn_winter_medium_2</span> <span class="o">=</span> <span class="n">meanNN</span><span class="p">(</span>
    <span class="n">winter_medium_bob</span><span class="p">,</span> <span class="n">winter_medium_iac</span>
<span class="p">)</span>
<span class="n">nndist_winter_cold_2</span><span class="p">,</span> <span class="n">meannn_winter_cold_2</span> <span class="o">=</span> <span class="n">meanNN</span><span class="p">(</span><span class="n">winter_cold_bob</span><span class="p">,</span> <span class="n">winter_cold_iac</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-the-results">
<h3 style="color: black; background-color: rgb(190,223,185); padding: 3px; border-radius: 5px;">Plot the results<a class="headerlink" href="#plot-the-results" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">nndist_winter_cold_2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter cold"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">nndist_winter_medium_2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter medium"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">nndist_winter_warm_2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter warm"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"BOB -&gt; IAC"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"distance to nearest neighbor [a.u.]"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">meannn_winter_cold_2</span><span class="p">,</span>
    <span class="n">c</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">":"</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Winter cold: </span><span class="si">{</span><span class="n">meannn_winter_cold_2</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">meannn_winter_medium_2</span><span class="p">,</span>
    <span class="n">c</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">"--"</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Winter medium: </span><span class="si">{</span><span class="n">meannn_winter_medium_2</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span>
    <span class="n">meannn_winter_warm_2</span><span class="p">,</span>
    <span class="n">c</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"Winter warm: </span><span class="si">{</span><span class="n">meannn_winter_warm_2</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7ff6a16dc680&gt;
</pre></div>
</div>
<img alt="../../_images/b77ba446e29909335c66e64fadae5cbf32703fb4d17fd8d44fd1944a483c563f.png" src="../../_images/b77ba446e29909335c66e64fadae5cbf32703fb4d17fd8d44fd1944a483c563f.png"/>
</div>
</div>
</section>
</section>
<hr class="docutils"/>
<section id="nearest-neighbor-function">
<h2 style="color: black; background-color: rgb(127,196,125); padding: 3px; border-radius: 5px;">3. Nearest neighbor function<a class="headerlink" href="#nearest-neighbor-function" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">nearest_neighbor_function</span><span class="p">(</span>
    <span class="n">points1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">points2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">radii</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Computes the nearest neighbor function for a set of 2D points.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - points1: array of shape (n_points, 2) representing the coordinates of the first set of points</span>
<span class="sd">    - points2: array of shape (n_points, 2) representing the coordinates of the second set of points</span>
<span class="sd">    - radii: array-like of radii at which to evaluate the nearest neighbor function</span>
<span class="sd">    Returns:</span>
<span class="sd">    - S: array of nearest neighbor function values at each radius</span>
<span class="sd">    - mu0: array of expected values under the null model at each radius</span>
<span class="sd">    """</span>

    <span class="c1"># calculate area based on bounding box of all points</span>
    <span class="n">allpoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">points1</span><span class="p">,</span> <span class="n">points2</span><span class="p">))</span>
    <span class="n">max_x</span><span class="p">,</span> <span class="n">max_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">allpoints</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">min_x</span><span class="p">,</span> <span class="n">min_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">allpoints</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">(</span><span class="n">max_x</span> <span class="o">-</span> <span class="n">min_x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">max_y</span> <span class="o">-</span> <span class="n">min_y</span><span class="p">)</span>

    <span class="n">n1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points1</span><span class="p">)</span>  <span class="c1"># number of points in the first set</span>
    <span class="n">d12</span> <span class="o">=</span> <span class="n">distance_matrix</span><span class="p">(</span><span class="n">points1</span><span class="p">,</span> <span class="n">points2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">points1</span> <span class="ow">is</span> <span class="n">points2</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">shares_memory</span><span class="p">(</span><span class="n">points1</span><span class="p">,</span> <span class="n">points2</span><span class="p">):</span>
        <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span>
            <span class="n">d12</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="p">)</span>  <span class="c1"># Set diagonal to infinity to ignore self-distances</span>

    <span class="n">min_dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">d12</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># nearest neighbor distances per point</span>

    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">radii</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">radii</span><span class="p">):</span>
        <span class="n">within_r</span> <span class="o">=</span> <span class="n">min_dists</span> <span class="o">&lt;</span> <span class="n">r</span>
        <span class="n">n_within_r</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">min_dists</span><span class="p">[</span><span class="n">within_r</span><span class="p">])</span>
        <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_within_r</span> <span class="o">/</span> <span class="n">n1</span>

    <span class="k">return</span> <span class="n">S</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_nn_function</span><span class="p">(</span>
    <span class="n">s</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">radii</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">nulldist</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"observed"</span><span class="p">,</span>
    <span class="n">line</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"-"</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Plots the nearest neighbor function S(r) with optional null model mean.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - s: array of S(r) values</span>
<span class="sd">    - radii: array of radii at which S(r) is evaluated</span>
<span class="sd">    - nulldist: optional array of null model mean values; if provided, plotted in red</span>
<span class="sd">    - show: if True, displays the plot; if False, only prepares the plot</span>
<span class="sd">    - label: label for the S(r) line in the plot</span>
<span class="sd">    - line: line style for the S(r) plot; default is solid line</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">nulldist</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">radii</span><span class="p">,</span> <span class="n">nulldist</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">"red"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"null‐model mean"</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">radii</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">"</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">line</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"r"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"S(r)"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="define-radii-for-which-to-evaluate-the-nearest-neighbor-function">
<h3 style="color: black; background-color: rgb(190,223,185); padding: 3px; border-radius: 5px;">Define radii for which to evaluate the nearest neighbor function<a class="headerlink" href="#define-radii-for-which-to-evaluate-the-nearest-neighbor-function" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="inspect-the-fall-samples">
<h4>Inspect the fall samples<a class="headerlink" href="#inspect-the-fall-samples" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s_fall_med</span> <span class="o">=</span> <span class="n">nearest_neighbor_function</span><span class="p">(</span><span class="n">fall_med_iac</span><span class="p">,</span> <span class="n">fall_med_bob</span><span class="p">,</span> <span class="n">radii</span><span class="p">)</span>
<span class="n">s_fall_warm</span> <span class="o">=</span> <span class="n">nearest_neighbor_function</span><span class="p">(</span><span class="n">fall_warm_iac</span><span class="p">,</span> <span class="n">fall_warm_bob</span><span class="p">,</span> <span class="n">radii</span><span class="p">)</span>
<span class="n">s_fall_cold</span> <span class="o">=</span> <span class="n">nearest_neighbor_function</span><span class="p">(</span><span class="n">fall_cold_iac</span><span class="p">,</span> <span class="n">fall_cold_bob</span><span class="p">,</span> <span class="n">radii</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_nn_function</span><span class="p">(</span><span class="n">s_fall_cold</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fall cold"</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">":"</span><span class="p">)</span>
<span class="n">plot_nn_function</span><span class="p">(</span><span class="n">s_fall_med</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fall medium"</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">"--"</span><span class="p">)</span>
<span class="n">plot_nn_function</span><span class="p">(</span><span class="n">s_fall_warm</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fall warm"</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">"-"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b4c328d0c9f7b70799bfb558f3364f94f23f02edc465956fb3d2ae69e6a853bd.png" src="../../_images/b4c328d0c9f7b70799bfb558f3364f94f23f02edc465956fb3d2ae69e6a853bd.png"/>
</div>
</div>
</section>
<section id="inspect-the-winter-samples">
<h4>Inspect the winter samples<a class="headerlink" href="#inspect-the-winter-samples" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s_winter_warm</span> <span class="o">=</span> <span class="n">nearest_neighbor_function</span><span class="p">(</span><span class="n">winter_warm_iac</span><span class="p">,</span> <span class="n">winter_warm_bob</span><span class="p">,</span> <span class="n">radii</span><span class="p">)</span>
<span class="n">s_winter_medium</span> <span class="o">=</span> <span class="n">nearest_neighbor_function</span><span class="p">(</span><span class="n">winter_medium_iac</span><span class="p">,</span> <span class="n">winter_medium_bob</span><span class="p">,</span> <span class="n">radii</span><span class="p">)</span>
<span class="n">s_winter_cold</span> <span class="o">=</span> <span class="n">nearest_neighbor_function</span><span class="p">(</span><span class="n">winter_cold_iac</span><span class="p">,</span> <span class="n">winter_cold_bob</span><span class="p">,</span> <span class="n">radii</span><span class="p">)</span>
<span class="n">s_winter_warm_2</span> <span class="o">=</span> <span class="n">nearest_neighbor_function</span><span class="p">(</span><span class="n">winter_warm_bob</span><span class="p">,</span> <span class="n">winter_warm_iac</span><span class="p">,</span> <span class="n">radii</span><span class="p">)</span>
<span class="n">s_winter_medium_2</span> <span class="o">=</span> <span class="n">nearest_neighbor_function</span><span class="p">(</span>
    <span class="n">winter_medium_bob</span><span class="p">,</span> <span class="n">winter_medium_iac</span><span class="p">,</span> <span class="n">radii</span>
<span class="p">)</span>
<span class="n">s_winter_cold_2</span> <span class="o">=</span> <span class="n">nearest_neighbor_function</span><span class="p">(</span><span class="n">winter_cold_bob</span><span class="p">,</span> <span class="n">winter_cold_iac</span><span class="p">,</span> <span class="n">radii</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_nn_function</span><span class="p">(</span>
    <span class="n">s_winter_cold</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter cold IAC -&gt; BOB"</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">":"</span>
<span class="p">)</span>
<span class="n">plot_nn_function</span><span class="p">(</span>
    <span class="n">s_winter_medium</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter medium IAC -&gt; BOB"</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">"--"</span>
<span class="p">)</span>
<span class="n">plot_nn_function</span><span class="p">(</span>
    <span class="n">s_winter_warm</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter warm IAC -&gt; BOB"</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">"-"</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/598a295cc8142d1693886fb90548c9c771782d2db1773cfc7f628b9ad449dfdd.png" src="../../_images/598a295cc8142d1693886fb90548c9c771782d2db1773cfc7f628b9ad449dfdd.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_nn_function</span><span class="p">(</span>
    <span class="n">s_winter_cold_2</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter cold BOB -&gt; IAC"</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">":"</span>
<span class="p">)</span>
<span class="n">plot_nn_function</span><span class="p">(</span>
    <span class="n">s_winter_medium_2</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter medium BOB -&gt; IAC"</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">"--"</span>
<span class="p">)</span>
<span class="n">plot_nn_function</span><span class="p">(</span>
    <span class="n">s_winter_warm_2</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter warm BOB -&gt; IAC"</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">"-"</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3e83ee075baaabb003027526b72221b0f70d285a744b408d3110bbc4be15ea43.png" src="../../_images/3e83ee075baaabb003027526b72221b0f70d285a744b408d3110bbc4be15ea43.png"/>
</div>
</div>
</section>
</section>
</section>
<hr class="docutils"/>
<section id="ripley-s-k-function">
<h2 style="color: black; background-color: rgb(127,196,125); padding: 3px; border-radius: 5px;">4. Ripley’s K function<a class="headerlink" href="#ripley-s-k-function" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ripleys_k_function</span><span class="p">(</span>
    <span class="n">points1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">points2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">radii</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">area</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">edge_correction</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Computes Ripley's K function for a set of 2D points.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - points1: array of shape (n_points, 2) representing the coordinates of the first set of points</span>
<span class="sd">    - points2: array of shape (n_points, 2) representing the coordinates of the second set of points</span>
<span class="sd">    - radii: array-like of radii at which to evaluate K</span>
<span class="sd">    - area: total area of the observation window; if None, calculated from bounding box</span>
<span class="sd">    - edge_correction: if True, applies basic border edge correction</span>

<span class="sd">    Returns:</span>
<span class="sd">    - ks: K-function values at each radius</span>
<span class="sd">    """</span>

    <span class="c1">#### Get the number of points</span>
    <span class="n">n1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points1</span><span class="p">)</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points2</span><span class="p">)</span>
    <span class="n">ks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">radii</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">dists</span> <span class="o">=</span> <span class="n">distance_matrix</span><span class="p">(</span><span class="n">points1</span><span class="p">,</span> <span class="n">points2</span><span class="p">)</span>

    <span class="c1">#### Compute area if not provided</span>
    <span class="n">allpoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">points1</span><span class="p">,</span> <span class="n">points2</span><span class="p">))</span>
    <span class="n">max_x</span><span class="p">,</span> <span class="n">max_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">allpoints</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">area</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">min_x</span><span class="p">,</span> <span class="n">min_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">allpoints</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">area</span> <span class="o">=</span> <span class="p">(</span><span class="n">max_x</span> <span class="o">-</span> <span class="n">min_x</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">max_y</span> <span class="o">-</span> <span class="n">min_y</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">min_x</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">min_y</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">max_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">max_x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">area</span><span class="p">)])</span>
        <span class="n">max_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">max_y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">area</span><span class="p">)])</span>

    <span class="k">if</span> <span class="n">edge_correction</span><span class="p">:</span>
        <span class="c1"># Determine FOV area</span>
        <span class="n">square</span> <span class="o">=</span> <span class="n">box</span><span class="p">(</span><span class="n">min_x</span><span class="p">,</span> <span class="n">min_y</span><span class="p">,</span> <span class="n">max_x</span><span class="p">,</span> <span class="n">max_y</span><span class="p">)</span>
        <span class="n">area_correction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">dists</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n2</span><span class="p">):</span>
                <span class="n">circle</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">points1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="n">dists</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">circle</span><span class="o">.</span><span class="n">area</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">circle</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">square</span><span class="p">)</span><span class="o">.</span><span class="n">area</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>  <span class="c1"># Avoid division by zero</span>
                <span class="n">area_correction</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">circle</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="n">circle</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">square</span><span class="p">)</span><span class="o">.</span><span class="n">area</span>

    <span class="k">if</span> <span class="n">points1</span> <span class="ow">is</span> <span class="n">points2</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">shares_memory</span><span class="p">(</span><span class="n">points1</span><span class="p">,</span> <span class="n">points2</span><span class="p">):</span>
        <span class="n">np</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">dists</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">radii</span><span class="p">):</span>
        <span class="n">within_r</span> <span class="o">=</span> <span class="n">dists</span> <span class="o">&lt;</span> <span class="n">r</span>

        <span class="k">if</span> <span class="n">edge_correction</span><span class="p">:</span>
            <span class="n">within_r</span> <span class="o">=</span> <span class="n">within_r</span> <span class="o">*</span> <span class="n">area_correction</span>

        <span class="n">count_within_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">within_r</span><span class="p">)</span>

        <span class="n">ks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">area</span> <span class="o">/</span> <span class="p">(</span><span class="n">n1</span> <span class="o">*</span> <span class="n">n2</span><span class="p">))</span> <span class="o">*</span> <span class="n">count_within_r</span>

    <span class="k">return</span> <span class="n">ks</span>
</pre></div>
</div>
</div>
</div>
<section id="define-radii-for-which-to-compute-ripley-s-k-function">
<h3 style="color: black; background-color: rgb(190,223,185); padding: 3px; border-radius: 5px;">Define radii for which to compute Ripley’s K function<a class="headerlink" href="#define-radii-for-which-to-compute-ripley-s-k-function" title="Link to this heading">#</a></h3>
</section>
<section id="exercise-think-should-these-be-the-same-maximum-radius-as-provided-to-the-nearest-neighbor-function">
<h3 style="color: black; background-color: rgb(252,185,118); padding: 3px; border-radius: 5px;">✍️ Exercise: Think: Should these be the same maximum radius as provided to the nearest neighbor function?<a class="headerlink" href="#exercise-think-should-these-be-the-same-maximum-radius-as-provided-to-the-nearest-neighbor-function" title="Link to this heading">#</a></h3>
<p>If yes, why?<br/>
If no, why not?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k_radii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5.01</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># radii for which to compute the K-function</span>
</pre></div>
</div>
</div>
</div>
<section id="compute-k-for-the-fall-samples">
<h4>Compute K for the fall samples<a class="headerlink" href="#compute-k-for-the-fall-samples" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k_fall_med</span> <span class="o">=</span> <span class="n">ripleys_k_function</span><span class="p">(</span><span class="n">fall_med_iac</span><span class="p">,</span> <span class="n">fall_med_bob</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
<span class="n">k_fall_cold</span> <span class="o">=</span> <span class="n">ripleys_k_function</span><span class="p">(</span><span class="n">fall_cold_iac</span><span class="p">,</span> <span class="n">fall_cold_bob</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
<span class="n">k_fall_warm</span> <span class="o">=</span> <span class="n">ripleys_k_function</span><span class="p">(</span><span class="n">fall_warm_iac</span><span class="p">,</span> <span class="n">fall_warm_bob</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="compute-k-for-the-winter-samples">
<h4>Compute K for the winter samples<a class="headerlink" href="#compute-k-for-the-winter-samples" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k_winter_warm</span> <span class="o">=</span> <span class="n">ripleys_k_function</span><span class="p">(</span>
    <span class="n">winter_warm_iac</span><span class="p">,</span> <span class="n">winter_warm_bob</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">400</span>
<span class="p">)</span>
<span class="n">k_winter_medium</span> <span class="o">=</span> <span class="n">ripleys_k_function</span><span class="p">(</span>
    <span class="n">winter_medium_iac</span><span class="p">,</span> <span class="n">winter_medium_bob</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">400</span>
<span class="p">)</span>
<span class="n">k_winter_cold</span> <span class="o">=</span> <span class="n">ripleys_k_function</span><span class="p">(</span>
    <span class="n">winter_cold_iac</span><span class="p">,</span> <span class="n">winter_cold_bob</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">400</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="here-we-change-the-order-to-bob-iac-for-k-winter-medium">
<h4>Here, we change the order to BOB -&gt; IAC for <code class="docutils literal notranslate"><span class="pre">k_winter_medium</span></code><a class="headerlink" href="#here-we-change-the-order-to-bob-iac-for-k-winter-medium" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k_winter_medium_2</span> <span class="o">=</span> <span class="n">ripleys_k_function</span><span class="p">(</span>
    <span class="n">winter_medium_bob</span><span class="p">,</span> <span class="n">winter_medium_iac</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">400</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">k_winter_medium_2</span> <span class="o">==</span> <span class="n">k_winter_medium</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">[</span> <span style="color: #00ff00; text-decoration-color: #00ff00; font-style: italic">True</span>  <span style="color: #00ff00; text-decoration-color: #00ff00; font-style: italic">True</span>  <span style="color: #00ff00; text-decoration-color: #00ff00; font-style: italic">True</span>  <span style="color: #00ff00; text-decoration-color: #00ff00; font-style: italic">True</span>  <span style="color: #00ff00; text-decoration-color: #00ff00; font-style: italic">True</span>  <span style="color: #00ff00; text-decoration-color: #00ff00; font-style: italic">True</span>  <span style="color: #00ff00; text-decoration-color: #00ff00; font-style: italic">True</span>  <span style="color: #00ff00; text-decoration-color: #00ff00; font-style: italic">True</span>  <span style="color: #00ff00; text-decoration-color: #00ff00; font-style: italic">True</span>  <span style="color: #00ff00; text-decoration-color: #00ff00; font-style: italic">True</span>  <span style="color: #00ff00; text-decoration-color: #00ff00; font-style: italic">True</span><span style="font-weight: bold">]</span>
</pre>
</div></div>
</div>
</section>
<section id="inspect-the-results">
<h4>Inspect the results<a class="headerlink" href="#inspect-the-results" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_ripleys_k</span><span class="p">(</span>
    <span class="n">k</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">radii</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"uniform"</span><span class="p">,</span>
    <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">line</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"-"</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Plots Ripley's K function.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - k: array of K function values</span>
<span class="sd">    - radii: array of radii at which K is evaluated</span>
<span class="sd">    - label: label for the plot</span>
<span class="sd">    - show: whether to show the plot</span>
<span class="sd">    - line: line style for the plot</span>
<span class="sd">    """</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">radii</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">, no edge correction"</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">line</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"r"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"K(r)"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="fall-samples">
<h4>Fall samples<a class="headerlink" href="#fall-samples" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_ripleys_k</span><span class="p">(</span><span class="n">k_fall_cold</span><span class="p">,</span> <span class="n">k_radii</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fall cold"</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">":"</span><span class="p">)</span>
<span class="n">plot_ripleys_k</span><span class="p">(</span><span class="n">k_fall_med</span><span class="p">,</span> <span class="n">k_radii</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fall medium"</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">"--"</span><span class="p">)</span>
<span class="n">plot_ripleys_k</span><span class="p">(</span><span class="n">k_fall_warm</span><span class="p">,</span> <span class="n">k_radii</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fall warm"</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">"-"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ea43ff76e29683d0b28783f54e44e60905800912c399c7728f8d5a035901e2f0.png" src="../../_images/ea43ff76e29683d0b28783f54e44e60905800912c399c7728f8d5a035901e2f0.png"/>
</div>
</div>
</section>
<section id="winter-samples">
<h4>Winter samples<a class="headerlink" href="#winter-samples" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_ripleys_k</span><span class="p">(</span><span class="n">k_winter_cold</span><span class="p">,</span> <span class="n">k_radii</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter cold"</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">":"</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plot_ripleys_k</span><span class="p">(</span><span class="n">k_winter_medium</span><span class="p">,</span> <span class="n">k_radii</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter medium"</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">"--"</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plot_ripleys_k</span><span class="p">(</span><span class="n">k_winter_warm</span><span class="p">,</span> <span class="n">k_radii</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter warm"</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b589c30f50d9e30bdf7a1300992766d3ed51797dd92ef5e195fbbba731a8becb.png" src="../../_images/b589c30f50d9e30bdf7a1300992766d3ed51797dd92ef5e195fbbba731a8becb.png"/>
</div>
</div>
</section>
</section>
<section id="ripley-s-k-with-edge-correction">
<h3 style="color: black; background-color: rgb(190,223,185); padding: 3px; border-radius: 5px;">4.1 Ripley’s K with edge correction<a class="headerlink" href="#ripley-s-k-with-edge-correction" title="Link to this heading">#</a></h3>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_ripleys_k_ec</span><span class="p">(</span>
    <span class="n">k</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">k_corrected</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">radii</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"uniform"</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Plots Ripley's K function with and without edge correction.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - k: array of K function values without edge correction</span>
<span class="sd">    - k_corrected: array of K function values with edge correction</span>
<span class="sd">    - radii: array of radii at which K function is evaluated</span>
<span class="sd">    - label: label for the plot, default is "uniform"</span>
<span class="sd">    """</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">radii</span><span class="p">,</span>
        <span class="n">k</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">, no edge correction"</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">radii</span><span class="p">,</span>
        <span class="n">k_corrected</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">, edge correction"</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-."</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Ripley's K function"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"r"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"K(r)"</span><span class="p">)</span>
    <span class="c1"># plt.show()</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="compute-the-fall-samples">
<h4>Compute the fall samples<a class="headerlink" href="#compute-the-fall-samples" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k_fall_med_ec</span> <span class="o">=</span> <span class="n">ripleys_k_function</span><span class="p">(</span>
    <span class="n">fall_med_iac</span><span class="p">,</span> <span class="n">fall_med_bob</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">edge_correction</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">k_fall_warm_ec</span> <span class="o">=</span> <span class="n">ripleys_k_function</span><span class="p">(</span>
    <span class="n">fall_warm_iac</span><span class="p">,</span> <span class="n">fall_warm_bob</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">edge_correction</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">k_fall_cold_ec</span> <span class="o">=</span> <span class="n">ripleys_k_function</span><span class="p">(</span>
    <span class="n">fall_cold_iac</span><span class="p">,</span> <span class="n">fall_cold_bob</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">edge_correction</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">36</span><span class="p">],</span> <span class="n">line</span> <span class="mi">4</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">k_fall_med_ec</span> <span class="o">=</span> <span class="n">ripleys_k_function</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>     <span class="n">fall_med_iac</span><span class="p">,</span> <span class="n">fall_med_bob</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">edge_correction</span><span class="o">=</span><span class="kc">True</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="n">k_fall_warm_ec</span> <span class="o">=</span> <span class="n">ripleys_k_function</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="n">fall_warm_iac</span><span class="p">,</span> <span class="n">fall_warm_bob</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">edge_correction</span><span class="o">=</span><span class="kc">True</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">k_fall_cold_ec</span> <span class="o">=</span> <span class="n">ripleys_k_function</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>     <span class="n">fall_cold_iac</span><span class="p">,</span> <span class="n">fall_cold_bob</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">edge_correction</span><span class="o">=</span><span class="kc">True</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="p">)</span>

<span class="nn">Cell In[27], line 49,</span> in <span class="ni">ripleys_k_function</span><span class="nt">(points1, points2, radii, area, edge_correction)</span>
<span class="g g-Whitespace">     </span><span class="mi">47</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n2</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span>     <span class="n">circle</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">points1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="n">dists</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
<span class="ne">---&gt; </span><span class="mi">49</span>     <span class="k">if</span> <span class="n">circle</span><span class="o">.</span><span class="n">area</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">circle</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">square</span><span class="p">)</span><span class="o">.</span><span class="n">area</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">50</span>         <span class="k">continue</span>  <span class="c1"># Avoid division by zero</span>
<span class="g g-Whitespace">     </span><span class="mi">51</span>     <span class="n">area_correction</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">circle</span><span class="o">.</span><span class="n">area</span> <span class="o">/</span> <span class="n">circle</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">square</span><span class="p">)</span><span class="o">.</span><span class="n">area</span>

<span class="nn">File ~/work/bobiac/bobiac/.venv/lib/python3.12/site-packages/shapely/geometry/base.py:341,</span> in <span class="ni">BaseGeometry.area</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">338</span> <span class="nd">@property</span>
<span class="g g-Whitespace">    </span><span class="mi">339</span> <span class="k">def</span><span class="w"> </span><span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">340</span><span class="w">     </span><span class="sd">"""Unitless area of the geometry (float)."""</span>
<span class="ne">--&gt; </span><span class="mi">341</span>     <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">shapely</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

<span class="nn">File ~/work/bobiac/bobiac/.venv/lib/python3.12/site-packages/shapely/decorators.py:88,</span> in <span class="ni">multithreading_enabled.&lt;locals&gt;.wrapped</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">86</span>     <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">array_args</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">87</span>         <span class="n">arr</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">writeable</span> <span class="o">=</span> <span class="kc">False</span>
<span class="ne">---&gt; </span><span class="mi">88</span>     <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">89</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">90</span>     <span class="k">for</span> <span class="n">arr</span><span class="p">,</span> <span class="n">old_flag</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">array_args</span><span class="p">,</span> <span class="n">old_flags</span><span class="p">):</span>

<span class="nn">File ~/work/bobiac/bobiac/.venv/lib/python3.12/site-packages/shapely/measurement.py:23,</span> in <span class="ni">area</span><span class="nt">(geometry, **kwargs)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="kn">from</span><span class="w"> </span><span class="nn">shapely.decorators</span><span class="w"> </span><span class="kn">import</span> <span class="n">multithreading_enabled</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span>     <span class="s2">"area"</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>     <span class="s2">"bounds"</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>     <span class="mi">19</span>     <span class="s2">"total_bounds"</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span> <span class="p">]</span>
<span class="ne">---&gt; </span><span class="mi">23</span> <span class="nd">@multithreading_enabled</span>
<span class="g g-Whitespace">     </span><span class="mi">24</span> <span class="k">def</span><span class="w"> </span><span class="nf">area</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">25</span><span class="w">     </span><span class="sd">"""Compute the area of a (multi)polygon.</span>
<span class="g g-Whitespace">     </span><span class="mi">26</span><span class="sd"> </span>
<span class="g g-Whitespace">     </span><span class="mi">27</span><span class="sd">     Parameters</span>
<span class="sd">   (...)     48 </span>
<span class="g g-Whitespace">     </span><span class="mi">49</span><span class="sd">     """</span>
<span class="g g-Whitespace">     </span><span class="mi">50</span>     <span class="k">return</span> <span class="n">lib</span><span class="o">.</span><span class="n">area</span><span class="p">(</span><span class="n">geometry</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
</section>
<section id="compute-the-winter-samples">
<h4>Compute the winter samples<a class="headerlink" href="#compute-the-winter-samples" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k_winter_warm_ec</span> <span class="o">=</span> <span class="n">ripleys_k_function</span><span class="p">(</span>
    <span class="n">winter_warm_iac</span><span class="p">,</span> <span class="n">winter_warm_bob</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">edge_correction</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">k_winter_medium_ec</span> <span class="o">=</span> <span class="n">ripleys_k_function</span><span class="p">(</span>
    <span class="n">winter_medium_iac</span><span class="p">,</span> <span class="n">winter_medium_bob</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">edge_correction</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">k_winter_cold_ec</span> <span class="o">=</span> <span class="n">ripleys_k_function</span><span class="p">(</span>
    <span class="n">winter_cold_iac</span><span class="p">,</span> <span class="n">winter_cold_bob</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">edge_correction</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-a-fall-sample-with-edge-correction">
<h4>Plot a fall sample with edge correction<a class="headerlink" href="#plot-a-fall-sample-with-edge-correction" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_ripleys_k_ec</span><span class="p">(</span><span class="n">k_fall_warm</span><span class="p">,</span> <span class="n">k_fall_warm_ec</span><span class="p">,</span> <span class="n">k_radii</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fall warm"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-a-winter-sample-with-edge-correction">
<h4>Plot a winter sample with edge correction<a class="headerlink" href="#plot-a-winter-sample-with-edge-correction" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_ripleys_k_ec</span><span class="p">(</span><span class="n">k_winter_cold</span><span class="p">,</span> <span class="n">k_winter_cold_ec</span><span class="p">,</span> <span class="n">k_radii</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter cold"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<hr class="docutils"/>
<section id="validations-the-null-distribution">
<h2 style="color: black; background-color: rgb(127,196,125); padding: 3px; border-radius: 5px;">5. Validations - the null distribution<a class="headerlink" href="#validations-the-null-distribution" title="Link to this heading">#</a></h2>
<section id="calculate-the-null-distribution-of-the-nearest-neighbor-function">
<h3 style="color: black; background-color: rgb(190,223,185); padding: 3px; border-radius: 5px;">Calculate the null distribution of the nearest neighbor function<a class="headerlink" href="#calculate-the-null-distribution-of-the-nearest-neighbor-function" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">getnulldist</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">radii</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">area</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Computes the expected nearest neighbor distances under a null model for a set of 2D points.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - points2: array of shape (n_points, 2) representing the coordinates of the points to compute nearest n</span>
<span class="sd">    neighbor distances to</span>
<span class="sd">    - radii: array-like of radii at which to evaluate the null model</span>

<span class="sd">    Returns:</span>
<span class="sd">    - mu0: array of expected nearest neighbor distances at each radius</span>
<span class="sd">    """</span>

    <span class="n">mu0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">radii</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">radii</span><span class="p">):</span>
        <span class="n">mu0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="n">area</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">mu0</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-try-different-values-for-n-and-area">
<h3 style="color: black; background-color: rgb(252,185,118); padding: 3px; border-radius: 5px;">✍️ Exercise: Try different values for <code class="docutils literal notranslate"><span class="pre">n</span></code> and <code class="docutils literal notranslate"><span class="pre">area</span></code><a class="headerlink" href="#exercise-try-different-values-for-n-and-area" title="Link to this heading">#</a></h3>
<p>You can plot the cell directly below to inspect the effect on <code class="docutils literal notranslate"><span class="pre">nulldist</span></code>.<br/>
Try out different values.<br/>
Think what would be the correct values for the <strong>fall samples</strong>!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">1345345</span>  <span class="c1"># number of points in the dataset</span>
<span class="n">area</span> <span class="o">=</span> <span class="mi">4056780</span>  <span class="c1"># area of the FOV</span>

<span class="n">nulldist</span> <span class="o">=</span> <span class="n">getnulldist</span><span class="p">(</span>
    <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="n">area</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">radii</span>
<span class="p">)</span>  <span class="c1"># These are not good values for n and area. Change them!</span>
</pre></div>
</div>
</div>
</div>
<section id="plot-the-fall-samples">
<h4>Plot the fall samples<a class="headerlink" href="#plot-the-fall-samples" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_nn_function</span><span class="p">(</span><span class="n">s_fall_cold</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fall cold"</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">":"</span><span class="p">)</span>
<span class="n">plot_nn_function</span><span class="p">(</span><span class="n">s_fall_med</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fall medium"</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">"--"</span><span class="p">)</span>
<span class="n">plot_nn_function</span><span class="p">(</span>
    <span class="n">s_fall_warm</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fall warm"</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span> <span class="n">nulldist</span><span class="o">=</span><span class="n">nulldist</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-the-winter-samples">
<h4>Plot the winter samples<a class="headerlink" href="#plot-the-winter-samples" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_nn_function</span><span class="p">(</span><span class="n">s_winter_cold</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter cold"</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">":"</span><span class="p">)</span>
<span class="n">plot_nn_function</span><span class="p">(</span><span class="n">s_winter_medium</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter medium"</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="s2">"--"</span><span class="p">)</span>
<span class="n">plot_nn_function</span><span class="p">(</span>
    <span class="n">s_winter_warm</span><span class="p">,</span> <span class="n">radii</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter warm"</span><span class="p">,</span> <span class="n">nulldist</span><span class="o">=</span><span class="n">nulldist</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<hr class="docutils"/>
<section id="validation-monte-carlo-based-null-hypothesis-testing">
<h2 style="color: black; background-color: rgb(127,196,125); padding: 3px; border-radius: 5px;">6. Validation - Monte-Carlo based null-hypothesis testing<a class="headerlink" href="#validation-monte-carlo-based-null-hypothesis-testing" title="Link to this heading">#</a></h2>
<section id="exercise-code-along-blindly-throw-darts-at-a-20-x-20-cm-board">
<h3 style="color: black; background-color: rgb(252,185,118); padding: 3px; border-radius: 5px;">✍️ Exercise, code along: Blindly throw darts at a 20 x 20 cm board<a class="headerlink" href="#exercise-code-along-blindly-throw-darts-at-a-20-x-20-cm-board" title="Link to this heading">#</a></h3>
<div class="cell tag_teacher docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seed</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
<span class="n">board_x</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">board_y</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">n_darts</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">board_x</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_darts</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">board_y</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_darts</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"x [au]"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"y [au]"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Darts on a board"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">"equal"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="simulate-under-the-null-hypothesis">
<h3 style="color: black; background-color: rgb(190,223,185); padding: 3px; border-radius: 5px;">6.1 Simulate under the null hypothesis<a class="headerlink" href="#simulate-under-the-null-hypothesis" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">sample_uniform_points_batch</span><span class="p">(</span>
    <span class="n">ndraw</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">num_points</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span> <span class="n">x_max</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">y_max</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">42</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generate *ndraw* independent batches of 2-D points drawn from independent</span>
<span class="sd">    **uniform random** distributions on the rectangle ``[0, x_max] × [0, y_max]``.</span>

<span class="sd">    Unlike a “uniform grid,” the points are *randomly* scattered—each position</span>
<span class="sd">    inside the rectangle has equal probability of being chosen.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ndraw : int</span>
<span class="sd">        Number of batches to generate.</span>
<span class="sd">    num_points : int</span>
<span class="sd">        Number of points in each batch.</span>
<span class="sd">    x_max : int</span>
<span class="sd">        Maximum x-coordinate value.</span>
<span class="sd">    y_max : int</span>
<span class="sd">        Maximum y-coordinate value.</span>
<span class="sd">    seed : int</span>
<span class="sd">        Random seed for reproducibility.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">        Array of shape (ndraw, num_points, 2) containing the generated points.</span>
<span class="sd">    """</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">ndraw</span><span class="p">,</span> <span class="n">num_points</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y_max</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">ndraw</span><span class="p">,</span> <span class="n">num_points</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ndraw</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Sufficiently large for statistics.</span>
<span class="n">num_points_c1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fall_med_iac</span><span class="p">)</span>  <span class="c1"># Same number of points as c1</span>
<span class="n">num_points_c2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fall_med_bob</span><span class="p">)</span>  <span class="c1"># Same number of points as c2</span>

<span class="c1"># Generate random points for multiple samples, channel 1</span>
<span class="n">points_multiple_c1</span> <span class="o">=</span> <span class="n">sample_uniform_points_batch</span><span class="p">(</span>
    <span class="n">ndraw</span><span class="p">,</span> <span class="n">num_points</span><span class="o">=</span><span class="n">num_points_c1</span><span class="p">,</span> <span class="n">x_max</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">y_max</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="c1"># channel 2</span>
<span class="n">points_multiple_c2</span> <span class="o">=</span> <span class="n">sample_uniform_points_batch</span><span class="p">(</span>
    <span class="n">ndraw</span><span class="p">,</span> <span class="n">num_points</span><span class="o">=</span><span class="n">num_points_c2</span><span class="p">,</span> <span class="n">x_max</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">y_max</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">43</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="inspect-the-random-results">
<h4>Inspect the random results<a class="headerlink" href="#inspect-the-random-results" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plotpoints</span><span class="p">(</span><span class="n">points</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"Monte carlo simulated points"</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Plots a set of 2D points.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - points: array of shape (n_points, 2) representing the coordinates of the points</span>
<span class="sd">    - title: title of the plot</span>

<span class="sd">    """</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"x [au]"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"y [au]"</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">"equal"</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s2">"box"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_i</span> <span class="o">=</span> <span class="mi">999</span>
<span class="nb">print</span><span class="p">(</span><span class="n">points_multiple_c1</span><span class="p">[</span><span class="n">sample_i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">points_multiple_c2</span><span class="p">[</span><span class="n">sample_i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>


<span class="n">plotpoints</span><span class="p">(</span><span class="n">points_multiple_c1</span><span class="p">[</span><span class="n">sample_i</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plotpoints</span><span class="p">(</span><span class="n">points_multiple_c2</span><span class="p">[</span><span class="n">sample_i</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils"/>
<section id="validate-mean-nearest-neighbor-distance">
<h3 style="color: black; background-color: rgb(190,223,185); padding: 3px; border-radius: 5px;">6.2 Validate - Mean nearest neighbor distance<a class="headerlink" href="#validate-mean-nearest-neighbor-distance" title="Link to this heading">#</a></h3>
<section id="calculate-the-mean-nearest-neighbor-distance-for-each-random-dataset">
<h4>Calculate the mean nearest neighbor distance for each random dataset<a class="headerlink" href="#calculate-the-mean-nearest-neighbor-distance-for-each-random-dataset" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nn_multiple</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ndraw</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndraw</span><span class="p">):</span>  <span class="c1"># for all randomly generated samples</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">mean_i</span> <span class="o">=</span> <span class="n">meanNN</span><span class="p">(</span>
        <span class="n">points_multiple_c1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">points_multiple_c2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="p">)</span>  <span class="c1"># calculate their mean</span>
    <span class="n">nn_multiple</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_i</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-significance-level-for-later-testing">
<h4>Define significance level for later testing<a class="headerlink" href="#define-significance-level-for-later-testing" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># significance level. Only 5% of simulations under the null hypothesis will lie outside a 95% significance level</span>
<span class="n">bound_low</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">bound_upper</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">bound_low</span>

<span class="c1"># Compute percentiles for mean nearest neighbor distance of the simulated points</span>
<span class="n">percentile_low</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span>
    <span class="n">nn_multiple</span><span class="p">,</span> <span class="n">bound_low</span>
<span class="p">)</span>  <span class="c1"># Only alpha/2 % of simulations lie below this value</span>
<span class="n">percentile_high</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span>
    <span class="n">nn_multiple</span><span class="p">,</span> <span class="n">bound_upper</span>
<span class="p">)</span>  <span class="c1"># Only alpha/2 % of simulations lie above this value</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h4>Fall samples<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">nndist_fall_med</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fall medium"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">nndist_fall_cold</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fall cold"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">nndist_fall_warm</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fall warm"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"distance to nearest neighbor [a.u.]"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">meannn_fall_med</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">"--"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fall medium"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">meannn_fall_cold</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">":"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fall cold"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">meannn_fall_warm</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fall warm"</span><span class="p">)</span>

<span class="c1"># Now we display the confidence bounds</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span>
    <span class="n">percentile_low</span><span class="p">,</span>
    <span class="n">percentile_high</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"gray"</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"confidence band </span><span class="si">{</span><span class="n">bound_low</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">bound_upper</span><span class="si">}</span><span class="s2">%"</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h4>Winter samples<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">nndist_winter_cold</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter cold"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">nndist_winter_warm</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter warm"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"distance to nearest neighbor [a.u.]"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">meannn_winter_cold</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">":"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter cold"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">meannn_winter_warm</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Winter warm"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span>
    <span class="n">percentile_low</span><span class="p">,</span>
    <span class="n">percentile_high</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"gray"</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"confidence band </span><span class="si">{</span><span class="n">bound_low</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">bound_upper</span><span class="si">}</span><span class="s2">%"</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils"/>
<section id="validate-nearest-neighbor-function">
<h3 style="color: black; background-color: rgb(190,223,185); padding: 3px; border-radius: 5px;">6.3 Validate - Nearest neighbor function<a class="headerlink" href="#validate-nearest-neighbor-function" title="Link to this heading">#</a></h3>
<section id="plot-confidence-intervals-for-the-nearest-neighbor-function">
<h4>Plot confidence intervals for the nearest neighbor function:<a class="headerlink" href="#plot-confidence-intervals-for-the-nearest-neighbor-function" title="Link to this heading">#</a></h4>
<div class="cell tag_hide-cell docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell content</p>
<p class="expanded admonition-title">Hide code cell content</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_envelope</span><span class="p">(</span>
    <span class="n">s</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">s_multiple</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">radii</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"data"</span><span class="p">,</span>
    <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"K(r)"</span><span class="p">,</span>
    <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"-"</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Plots the envelope of a metric (e.g., Nearest neighbor function, or K-function) with confidence intervals.</span>
<span class="sd">    Parameters:</span>
<span class="sd">    - s: array of metric values for the observed data</span>
<span class="sd">    - s_multiple: array of metric values for multiple realizations (i.e. of monte Carlo simulations)</span>
<span class="sd">    - radii: array of radii at which the metric is evaluated</span>
<span class="sd">    - alpha: significance level for the confidence interval (default is 5)</span>
<span class="sd">    - label: label for the observed data in the plot</span>
<span class="sd">    - metric: name of the metric being plotted (default is "K(r)" for ripley's K function)</span>
<span class="sd">    - show: whether to show the plot (default is True).</span>
<span class="sd">    If False, the plot is not shown but can be saved or further processed.</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>  <span class="c1"># show confidence intervals</span>
        <span class="n">ndraw</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_multiple</span><span class="p">)</span>
        <span class="n">s_multiple_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">s_multiple</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">bound_low</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">bound_upper</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="n">bound_low</span>
        <span class="n">percentiles_low</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">s_multiple</span><span class="p">,</span> <span class="n">bound_low</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">percentiles_high</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">s_multiple</span><span class="p">,</span> <span class="n">bound_upper</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>  <span class="c1"># plot the mean of the multiple realizations</span>
            <span class="n">radii</span><span class="p">,</span>
            <span class="n">s_multiple_mean</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">"grey"</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"mean of </span><span class="si">{</span><span class="n">ndraw</span><span class="si">}</span><span class="s2"> realizations"</span><span class="p">,</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>  <span class="c1"># fill the area between the percentiles</span>
            <span class="n">radii</span><span class="p">,</span>
            <span class="n">percentiles_low</span><span class="p">,</span>
            <span class="n">percentiles_high</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">"grey"</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">bound_low</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">bound_upper</span><span class="si">}</span><span class="s2">% quantile range"</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">radii</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"k"</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span>
    <span class="p">)</span>  <span class="c1"># plot the observed data</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"r"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1"># if show:</span>
    <span class="c1">#     plt.show()</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="compute-the-nearest-neighbor-function-for-all-random-samples">
<h3 style="color: black; background-color: rgb(190,223,185); padding: 3px; border-radius: 5px;">Compute the nearest neighbor function for all random samples<a class="headerlink" href="#compute-the-nearest-neighbor-function-for-all-random-samples" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s_multiple</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">ndraw</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">radii</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndraw</span><span class="p">):</span>  <span class="c1"># for all randomly generated samples</span>
    <span class="n">s_multiple</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">nearest_neighbor_function</span><span class="p">(</span>
        <span class="n">points_multiple_c1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">points_multiple_c2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">radii</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="id3">
<h4>Fall samples<a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_envelope</span><span class="p">(</span>
    <span class="n">s_fall_cold</span><span class="p">,</span>
    <span class="n">s_multiple</span><span class="p">,</span>
    <span class="n">radii</span><span class="o">=</span><span class="n">radii</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="s2">"S(r)"</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">"Fall cold"</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">":"</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plot_envelope</span><span class="p">(</span>
    <span class="n">s_fall_med</span><span class="p">,</span>
    <span class="n">s_multiple</span><span class="p">,</span>
    <span class="n">radii</span><span class="o">=</span><span class="n">radii</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="s2">"S(r)"</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">"Fall medium"</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">"--"</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plot_envelope</span><span class="p">(</span>
    <span class="n">s_fall_warm</span><span class="p">,</span>
    <span class="n">s_multiple</span><span class="p">,</span>
    <span class="n">radii</span><span class="o">=</span><span class="n">radii</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="s2">"S(r)"</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">"-"</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">"Fall warm"</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h4>Winter samples<a class="headerlink" href="#id4" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_envelope</span><span class="p">(</span>
    <span class="n">s_winter_cold</span><span class="p">,</span>
    <span class="n">s_multiple</span><span class="p">,</span>
    <span class="n">radii</span><span class="o">=</span><span class="n">radii</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="s2">"S(r)"</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">"Winter cold"</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">":"</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plot_envelope</span><span class="p">(</span>
    <span class="n">s_winter_warm</span><span class="p">,</span>
    <span class="n">s_multiple</span><span class="p">,</span>
    <span class="n">radii</span><span class="o">=</span><span class="n">radii</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="s2">"S(r)"</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">"Winter warm"</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils"/>
<section id="validate-ripley-s-k">
<h3 style="color: black; background-color: rgb(190,223,185); padding: 3px; border-radius: 5px;">6.4 Validate - Ripley’s K<a class="headerlink" href="#validate-ripley-s-k" title="Link to this heading">#</a></h3>
<p>Here, we can reuse the sample plotting function as defined for the nearest neighbor function</p>
<section id="compute-ripley-s-k-for-all-randomly-generated-samples">
<h4>Compute Ripley’s K for all randomly generated samples<a class="headerlink" href="#compute-ripley-s-k-for-all-randomly-generated-samples" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ks_multiple</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">ndraw</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">k_radii</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndraw</span><span class="p">):</span>
    <span class="n">ks_multiple</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ripleys_k_function</span><span class="p">(</span>
        <span class="n">points_multiple_c1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
        <span class="n">points_multiple_c2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
        <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span>
        <span class="n">area</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span>
        <span class="n">edge_correction</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h4>Fall samples<a class="headerlink" href="#id5" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_envelope</span><span class="p">(</span>
    <span class="n">k_fall_cold</span><span class="p">,</span>
    <span class="n">ks_multiple</span><span class="p">,</span>
    <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="s2">"K(r)"</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">"Fall cold"</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">":"</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plot_envelope</span><span class="p">(</span>
    <span class="n">k_fall_med</span><span class="p">,</span>
    <span class="n">ks_multiple</span><span class="p">,</span>
    <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="s2">"K(r)"</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">"Fall medium"</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">"--"</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plot_envelope</span><span class="p">(</span>
    <span class="n">k_fall_warm</span><span class="p">,</span> <span class="n">ks_multiple</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">"K(r)"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Fall warm"</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id6">
<h4>Winter samples<a class="headerlink" href="#id6" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_envelope</span><span class="p">(</span>
    <span class="n">k_winter_cold</span><span class="p">,</span>
    <span class="n">ks_multiple</span><span class="p">,</span>
    <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="s2">"K(r)"</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">"Winter cold"</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">":"</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plot_envelope</span><span class="p">(</span>
    <span class="n">k_winter_warm</span><span class="p">,</span>
    <span class="n">ks_multiple</span><span class="p">,</span>
    <span class="n">radii</span><span class="o">=</span><span class="n">k_radii</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="s2">"K(r)"</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">"Winter warm"</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/08_colocalization"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</article>
<footer class="prev-next-footer d-print-none">
<div class="prev-next-area">
<a class="left-prev" href="pixel_intensity_based_colocalization_manders.html" title="previous page">
<i class="fa-solid fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">Manders’ Correlation Coefficients</p>
</div>
</a>
<a class="right-next" href="../09_reproducibility_and_image_ethics/reproducibility_and_image_ethics.html" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">09 - <i class="fa-solid fa-rotate-right"></i> Reproducibility and Image Ethics</p>
</div>
<i class="fa-solid fa-angle-right"></i>
</a>
</div>
</footer>
</div>
<div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">
<div class="sidebar-secondary-item">
<div class="page-toc tocsection onthispage">
<i class="fa-solid fa-list"></i> Contents
  </div>
<nav class="bd-toc-nav page-toc">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Object-based colocalization analysis</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#description">Description</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objectives">Objectives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-data">0. Load the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-data">1. Plot the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mean-nearest-neighbor-distance">2. Mean nearest neighbor distance</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-code-along">✍️ Exercise: Code along</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-fall-samples">Compute Fall samples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-fall-samples">Plot Fall samples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-winter-samples">Compute Winter samples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-winter-samples">Plot Winter samples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-change-the-order-of-points-provided-to-meannn-for-the-winter-samples">✍️ Exercise: Change the order of points provided to <code class="docutils literal notranslate"><span class="pre">meanNN()</span></code> for the winter samples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-results">Plot the results</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nearest-neighbor-function">3. Nearest neighbor function</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-radii-for-which-to-evaluate-the-nearest-neighbor-function">Define radii for which to evaluate the nearest neighbor function</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-fall-samples">Inspect the fall samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-winter-samples">Inspect the winter samples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ripley-s-k-function">4. Ripley’s K function</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-radii-for-which-to-compute-ripley-s-k-function">Define radii for which to compute Ripley’s K function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-think-should-these-be-the-same-maximum-radius-as-provided-to-the-nearest-neighbor-function">✍️ Exercise: Think: Should these be the same maximum radius as provided to the nearest neighbor function?</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-k-for-the-fall-samples">Compute K for the fall samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-k-for-the-winter-samples">Compute K for the winter samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#here-we-change-the-order-to-bob-iac-for-k-winter-medium">Here, we change the order to BOB -&gt; IAC for <code class="docutils literal notranslate"><span class="pre">k_winter_medium</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-results">Inspect the results</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fall-samples">Fall samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#winter-samples">Winter samples</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ripley-s-k-with-edge-correction">4.1 Ripley’s K with edge correction</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-fall-samples">Compute the fall samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-winter-samples">Compute the winter samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-a-fall-sample-with-edge-correction">Plot a fall sample with edge correction</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-a-winter-sample-with-edge-correction">Plot a winter sample with edge correction</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validations-the-null-distribution">5. Validations - the null distribution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-null-distribution-of-the-nearest-neighbor-function">Calculate the null distribution of the nearest neighbor function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-try-different-values-for-n-and-area">✍️ Exercise: Try different values for <code class="docutils literal notranslate"><span class="pre">n</span></code> and <code class="docutils literal notranslate"><span class="pre">area</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-fall-samples">Plot the fall samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-winter-samples">Plot the winter samples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validation-monte-carlo-based-null-hypothesis-testing">6. Validation - Monte-Carlo based null-hypothesis testing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-code-along-blindly-throw-darts-at-a-20-x-20-cm-board">✍️ Exercise, code along: Blindly throw darts at a 20 x 20 cm board</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simulate-under-the-null-hypothesis">6.1 Simulate under the null hypothesis</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#inspect-the-random-results">Inspect the random results</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-mean-nearest-neighbor-distance">6.2 Validate - Mean nearest neighbor distance</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-mean-nearest-neighbor-distance-for-each-random-dataset">Calculate the mean nearest neighbor distance for each random dataset</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-significance-level-for-later-testing">Define significance level for later testing</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Fall samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Winter samples</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-nearest-neighbor-function">6.3 Validate - Nearest neighbor function</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-confidence-intervals-for-the-nearest-neighbor-function">Plot confidence intervals for the nearest neighbor function:</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-nearest-neighbor-function-for-all-random-samples">Compute the nearest neighbor function for all random samples</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Fall samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Winter samples</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-ripley-s-k">6.4 Validate - Ripley’s K</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-ripley-s-k-for-all-randomly-generated-samples">Compute Ripley’s K for all randomly generated samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Fall samples</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Winter samples</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav></div>
</div></div>
</div>
<footer class="bd-footer-content">
<div class="bd-footer-content__inner container">
<div class="footer-item">
<p class="component-author">
By Federico Gasparoli - federico.gasparoli@gmail.com, Image Analysis Collaboratory @ Harvard Medical School
</p>
</div>
<div class="footer-item">
<p class="copyright">
    
      © Copyright 2025.
      <br/>
</p>
</div>
<div class="footer-item">
</div>
<div class="footer-item">
<div class="extra_footer">
<p>
All content is licensed under <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC-BY 4.0</a>, except where noted otherwise.
</p>
</div>
</div>
</div>
</footer>
</main>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>
<footer class="bd-footer">
</footer>
</body>
</html>